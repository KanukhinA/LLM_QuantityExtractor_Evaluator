{
  "timestamp": "20260117_184302",
  "model_name": "google/t5gemma-2-1b-1b",
  "interrupted": false,
  "processed_count": 100,
  "total_count": 100,
  "multi_agent_mode": null,
  "gpu_info": {
    "cuda_available": true,
    "cuda_version": "12.1",
    "gpu_name": "NVIDIA GeForce RTX 4060 Laptop GPU",
    "gpu_memory_total_gb": 8.0,
    "gpu_memory_allocated_gb": 0.0,
    "gpu_memory_reserved_gb": 0.0,
    "gpu_name_detailed": "NVIDIA GeForce RTX 4060 Laptop GPU",
    "driver_version": "591.74"
  },
  "gpu_memory_after_load_gb": 3.94,
  "gpu_memory_during_inference_gb": 3.94,
  "gpu_memory_during_inference_max_gb": 3.94,
  "gpu_memory_during_inference_min_gb": 3.94,
  "api_model": false,
  "average_response_time_seconds": 0.0,
  "parsing_error_rate": 1.0,
  "parsing_errors_count": 200,
  "quality_metrics": {
    "массовая доля": {
      "средняя_точность": 0.0,
      "precision": 0.0,
      "recall": 0.0,
      "f1": 0.0,
      "tp": 0,
      "fp": 0,
      "fn": 279,
      "количество_сравнений": 84,
      "ошибки": [
        "Вещество P2O5: предсказано отсутствует, истина [19.0, 21.0]",
        "Вещество K2O: предсказано отсутствует, истина [29.0, 31.0]",
        "Вещество S: предсказано отсутствует, истина [2.0, None]",
        "Вещество N: предсказано отсутствует, истина [7.0, 9.0]",
        "Вещество K2O: предсказано отсутствует, истина 50.0",
        "Вещество SO4: предсказано отсутствует, истина 52.5",
        "Вещество Cl: предсказано отсутствует, истина 1.0",
        "Вещество P2O5: предсказано отсутствует, истина 10.0",
        "Вещество K2O: предсказано отсутствует, истина 10.0",
        "Вещество N: предсказано отсутствует, истина 20.0"
      ]
    },
    "прочее": {
      "средняя_точность": 0.0,
      "precision": 0.0,
      "recall": 0.0,
      "f1": 0.0,
      "tp": 0,
      "fp": 0,
      "fn": 216,
      "количество_сравнений": 78,
      "ошибки": [
        "Параметр стандарт: предсказано отсутствует, истина ту 20.15.52-089-05785164-2022",
        "Параметр марка: предсказано отсутствует, истина npks-8 (npk 8:20:30)",
        "Параметр стандарт: предсказано отсутствует, истина ту 20.15.71-142-05015182-2017",
        "Параметр масса брутто: предсказано отсутствует, истина 1050.0",
        "Параметр количество вагонов: предсказано отсутствует, истина 15.0",
        "Параметр стандарт: предсказано отсутствует, истина ту 2181-073-05761695-2016",
        "Параметр масса нетто: предсказано отсутствует, истина 1035000.0",
        "Параметр масса нетто единицы: предсказано отсутствует, истина 50.0",
        "Параметр марка: предсказано отсутствует, истина npk 16-16-16",
        "Параметр стандарт: предсказано отсутствует, истина ту 20.15.71-031-00206486-2023"
      ]
    }
  },
  "hyperparameters": {
    "max_new_tokens": 1024,
    "do_sample": false,
    "dtype": "bfloat16"
  },
  "prompt_template": "build_prompt3",
  "prompt_full_text": "\nТы — эксперт по извлечению численных и количественных характеристик из текстов о химических веществах и удобрениях.  \nТвоя задача:  \n\n1. Найти все численные признаки в тексте, например:  \n   - Массовую долю элементов (массовая доля N, массовая доля P2O5 и др.) в процентах.  \n   - Количество товара (кг, т, п/э мешки, вагон и др.).  \n   - Прочие численные показатели, указанные в тексте (марки, стандарты (ТУ, ГОСТ и др.), идентификаторы).  \n\n2. Для каждого численного признака определить:  \n   - Название признака (например, \"массовая доля N\", \"массовая доля P2O5\", \"массовая доля К2О\", \"массовая доля S\", \"масса нетто единицы\", \"масса нетто\", \"масса K2O\", \"масса брутто\", \"количество вагонов\", \"стандарт\" и т.д.)  \n   - Значение (число, если есть диапазон — брать оба значения; для стандарта указываешь полный номер стандарта со словами ГОСТ/ТУ или др.)  \n   - Единицу измерения (%, кг, т, шт, п/э меш, вагон, или пусто для стандарта)  \n\n3. Особые указания:\n   - Извлекай на русском\n   - Если признак указан как диапазон из нескольких чисел (например \"8-10\", или \"от 6 до 12\") или с погрешностью (+/-), укажи оба числа в формате [min, max]. \n   - Извлекай логические/сравнительные операторы, если они присутствуют в тексте: «не менее» - [min, null] «не более» - [null, max]\n   - Используй точку в качестве разделителя десятичных чисел.\n   - Название вещества и его массовая доля могут встречаться в марке (например, \"N7-P20-K30-S3\"),  используй данные из марки, если нет иных данных по массовой доле вещества.\n   - Если в названии признака есть название химического элемента (например Кальций) - замени его на обозначение химического элемента - Ca.\n   - Названия признаков пиши с маленькой буквы. Например \"массовая доля Zn\".\n   - Если указано например \"МАССОВАЯ ДОЛЯ K В ПЕРЕСЧЕТЕ НА К2О\" - то правильным извлекаемым признаком будет \"массовая доля K2O\".\n   - Если один и тот же параметр встречается дважды — сначала как общее условие (например, «с содержанием азота более 10%»), а затем как конкретное значение (например, «азот 16%»), указывай только конкретное значение.\n   - Для массы с упаковкой - называй признак \"масса брутто\" вне зависимости от наименования упаковки. Если указывается просто масса в формате \"МЕШКИ ПО 50 КГ\" - это признак \"масса нетто\".\n   - Если дается масса в виде \"ПО 1000 КГ+5%\" - указывай в признаке \"масса брутто\" одно значение - 1050.\n   - Для прочих признаков (всех признаков, помимо \"массовой доли\") указывай единицы измерения (за исключением признаков \"марка\" и \"стандарт\")\n   - Если признака в тексте нет - не извлекай его и не выводи его в json.\n\n4 . Выводи строго JSON следующего вида (пример):\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [26, 28]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20, null]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 20},\n    {\"вещество\": \"S\", \"массовая доля\": 3},\n    {\"вещество\": \"NH4+\", \"массовая доля\": [null, 2]}\n  ],\n  \"прочее\": [\n    {\"параметр\": \"масса нетто единицы\", \"масса\": 50, \"единица\": \"кг\"},\n    {\"параметр\": \"масса брутто\", \"масса\": 1020, \"единица\": \"кг\"},\n    {\"параметр\": \"количество поддонов\", \"количество\": 20, \"единица\": \"шт\"},\n    {\"параметр\": \"количество мешков\", \"количество\": 1000, \"единица\": \"шт\"},\n    {\"параметр\": \"объем нетто единицы\", \"объем\": 10, \"единица\": \"л\"},\n    {\"параметр\": \"стандарт\", \"значение\": \"ТУ 2184-037-32496445-02\"},\n    {\"параметр\": \"марка\", \"значение\": \"N7-P20-K30-S3\"}\n  ]\n}\n```\n\n5. Выводи json результат **только после слова ОТВЕТ:**.\n\nТекст для анализа:\nКАЛИЙ СЕРНОКИСЛЫЙ ИЗ НЕФЕЛИНОВОГО СЫPЬЯ ТУ 20.15.52-089-05785164-2022, ПРЕДНАЗНАЧЕН ДЛЯ ПРИМЕНЕНИЯ В КАЧЕСТВЕ МИНЕРАЛЬНОГО УДОБРЕНИЯ В СЕЛЬСКОМ ХОЗЯЙСТВЕ, ПОЛУЧАЮТ ИЗ ВЕТВИ ТЕХНОЛОГИЧЕСКОГО ПРОЦЕССА ПРОИЗВОДСТВА СОДОПРОДУКТОВ ИЗ РАСТВОРОВ ГЛИНОЗЕМНОГО ПРОИЗВОДСТВА\n",
  "prompt_info": null,
  "parsing_errors": [
    "Текст #0: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    inputs = tokenizer_or_processor(prompt, return_tenso",
    "Текст #0: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #1: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    inputs = tokenizer_or_processor(prompt, return_tenso",
    "Текст #1: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #2: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #2: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #3: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #3: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #4: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #4: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #5: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #5: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #6: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #6: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #7: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #7: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #8: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #8: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #9: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #9: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #10: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #10: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #11: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #11: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #12: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #12: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #13: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #13: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #14: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #14: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #15: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #15: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #16: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #16: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #17: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #17: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #18: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #18: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #19: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #19: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #20: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #20: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #21: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #21: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #22: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #22: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #23: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #23: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #24: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #24: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #25: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #25: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #26: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #26: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #27: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #27: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #28: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #28: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #29: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #29: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #30: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #30: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #31: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #31: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #32: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #32: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #33: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #33: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #34: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #34: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #35: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #35: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #36: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #36: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #37: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #37: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #38: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #38: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #39: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #39: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #40: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #40: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #41: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #41: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #42: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #42: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #43: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #43: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #44: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #44: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #45: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #45: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #46: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #46: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #47: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #47: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #48: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #48: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #49: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #49: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #50: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #50: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #51: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #51: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #52: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #52: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #53: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #53: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #54: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #54: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #55: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #55: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #56: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #56: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #57: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #57: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #58: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #58: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #59: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #59: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #60: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #60: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #61: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #61: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #62: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #62: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #63: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #63: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #64: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #64: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #65: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #65: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #66: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #66: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #67: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #67: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #68: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #68: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #69: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #69: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #70: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #70: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #71: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #71: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #72: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #72: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #73: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #73: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #74: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #74: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #75: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #75: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #76: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #76: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #77: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #77: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #78: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #78: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #79: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #79: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #80: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #80: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #81: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #81: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #82: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #82: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #83: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #83: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #84: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #84: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #85: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #85: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #86: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #86: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #87: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #87: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #88: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #88: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #89: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #89: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #90: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #90: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #91: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #91: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #92: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #92: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #93: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #93: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #94: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #94: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #95: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #95: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #96: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #96: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #97: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #97: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #98: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #98: не получен ответ. Ошибка: 'NoneType' object is not subscriptable",
    "Текст #99: критическая ошибка генерации после 2 попыток. Ошибка: 'NoneType' object is not subscriptable. Traceback: Traceback (most recent call last):\n  File \"C:\\D\\дзАрхив\\Магистратура\\Магистерская\\SmallLLMEvaluator\\model_loaders.py\", line 678, in generate_t5\n    # Удаляем стоп-строки\n              ~~~~^~~~~~~~\n  F",
    "Текст #99: не получен ответ. Ошибка: 'NoneType' object is not subscriptable"
  ],
  "total_samples": 100,
  "valid_json_count": 0,
  "invalid_json_count": 100,
  "gemini_analysis": {
    "status": "success",
    "analysis": "Приветствую! Я провел анализ результатов тестирования модели `google/t5gemma-2-1b-1b` для задачи извлечения численных и количественных характеристик.\n\n**Общий вывод:**\nМодель демонстрирует критически низкую производительность, фактически полностью не справляясь с задачей. Нулевые значения метрик Precision, Recall и F1 для обеих категорий, а также массовые ошибки генерации (`NoneType` object is not subscriptable), указывают на то, что модель либо не генерирует ответ вовсе, либо генерирует нечто совершенно непригодное для парсинга.\n\n---\n\n### 1. Характерные ошибки модели\n\n*   **Полное отсутствие извлечения данных:** Модель не смогла извлечь ни одного из требуемых признаков (массовые доли, стандарты, марки, количества и т.д.), что подтверждается нулевыми значениями метрик качества и примерами ошибок. Все истинные значения помечены как \"предсказано отсутствует\".\n*   **Критические ошибки генерации:** Вместо осмысленного ответа модель часто возвращает `None` или пустой/непарсируемый вывод, что приводит к ошибкам `'NoneType' object is not subscriptable` в процессе оценки. Это означает, что скрипт не получает ожидаемый строковый вывод для анализа.\n*   **Неспособность следовать сложным инструкциям:** Даже если бы модель не выдавала `None`, столь детальный и специфичный промпт, требующий точного форматирования (диапазоны, `null`, конвертации, специфические названия признаков), является вызовом для небольших моделей без дополнительных примеров.\n\n---\n\n### 2. Причины ошибок парсинга JSON\n\nОшибка `'NoneType' object is not subscriptable` в контексте \"ошибок парсинга JSON\" является несколько вводящей в заблуждение формулировкой. Она **не означает, что модель сгенерировала некорректный JSON**, который затем не удалось распарсить. Вместо этого, эта ошибка указывает на более фундаментальную проблему:\n\n*   **Модель не сгенерировала никакого текста:** Скорее всего, метод `generate` модели возвращает `None` (или пустую строку, которую затем обрабатывают как `None`), и скрипт оценки пытается обратиться к элементам этого `None` объекта, что и вызывает ошибку.\n*   **Причины отсутствия генерации:**\n    *   **Внутренняя ошибка модели/GPU:** Модель может \"зависать\" или не справляться с задачей генерации из-за нехватки ресурсов, слишком сложного промпта, или других внутренних проблем.\n    *   **Неправильно настроенные токены:** Возможно, `eos_token` (токен конца последовательности) срабатывает слишком рано или некорректно, заставляя модель прекращать генерацию до выдачи какого-либо осмысленного текста.\n    *   **Слишком строгий промпт/отсутствие \"начального стимула\":** В некоторых случаях, если промпт слишком сложен или не дает \"подсказки\" к началу ответа (например, ````json`), модель может испытывать трудности с инициализацией генерации.\n\n---\n\n### 3. Причины ошибок в извлечении данных\n\n*   **Основная причина – отсутствие генерации:** Если модель не генерирует вывод, она не может извлечь данные. Это объясняет нулевые метрики.\n*   **Малый размер модели:** `google/t5gemma-2-1b-1b` — это относительно небольшая модель (1 миллиард параметров). Такие модели часто требуют более тщательного промптинга, специфических примеров (few-shot learning) или даже дообучения (fine-tuning) для сложных, узкоспециализированных задач с конкретными форматами вывода.\n*   **Сложность задачи:** Извлечение структурированных данных с учетом множества правил (диапазоны, `null`, конвертация химических обозначений, нижний регистр, обработка марок и стандартов) является нетривиальной задачей даже для больших моделей, если они не были специально обучены.\n*   **Отсутствие Few-shot примеров:** В промпте не предоставлены примеры желаемого формата вывода (т.н. in-context learning или few-shot examples). Это критически важно для небольших моделей, чтобы они поняли не только, *что* извлекать, но и *как* это форматировать.\n*   **Неполный промпт:** Часть промпта \"Если один и тот же параметр встречается дважды — сначала как общее условие (например, «с содержанием азота более 10%»), а затем как конкр\" оборвана. Это может быть источником неопределенности для модели, хотя и вряд ли объясняет полное отсутствие генерации.\n\n---\n\n### 4. Рекомендации по улучшению промпта\n\n1.  **Завершить промпт:** Первоочередная задача — дописать оборванное предложение в конце промпта. Полные инструкции жизненно важны.\n2.  **Явно указать формат вывода (JSON):**\n    *   Промпт должен четко требовать вывод в формате JSON. Например: \"Выведи все найденные признаки в виде списка JSON объектов, где каждый объект имеет ключи 'название', 'значение', 'единица_измерения'. Корневой элемент должен быть JSON-объектом с ключом 'характеристики'.\"\n    *   Пример:\n        ```json\n        {\n          \"характеристики\": [\n            {\n              \"название\": \"массовая доля N\",\n              \"значение\": [7.0, 9.0],\n              \"единица_измерения\": \"%\"\n            },\n            {\n              \"название\": \"стандарт\",\n              \"значение\": \"ту 20.15.52-089-05785164-2022\",\n              \"единица_измерения\": \"\"\n            }\n          ]\n        }\n        ```\n3.  **Добавить Few-shot примеры (критически важно):** Для небольших моделей это абсолютно необходимо. Предоставьте 2-3 примера входного текста с соответствующим ожидаемым JSON-выводом. Выберите примеры, демонстрирующие:\n    *   Диапазоны (`[min, max]`)\n    *   Логические операторы (`[min, null]`, `[null, max]`)\n    *   Извлечение из марок (N7-P20-K30-S3)\n    *   Конвертацию K -> K2O\n    *   Различные единицы измерения\n    *   Примеры \"прочих\" параметров (стандарт, марка, масса брутто).\n4.  **Уточнить \"null\" в JSON:** Явно указать, что `null` должен быть именно JSON-значением `null`, а не строкой \"null\" или `None`.\n5.  **Ограничить \"болтовню\":** Добавьте инструкции, чтобы модель не добавляла никакого сопроводительного текста, кроме самого JSON: \"Отвечай строго в формате JSON. Никакого дополнительного текста или пояснений.\"\n6.  **Начальный \"стимул\" для генерации:** В конце промпта можно добавить ````json`, чтобы модель начала генерацию сразу с JSON-структуры.\n\n---\n\n### 5. Рекомендации по настройке гиперпараметров\n\nТекущие гиперпараметры являются разумными для задачи извлечения, но в свете полного отсутствия генерации, можно попробовать следующее:\n\n*   **`do_sample`: `false` (Оставить).** Для детерминированного извлечения это предпочтительно.\n*   **`max_new_tokens`: 1024 (Оставить).** Достаточно для ожидаемого вывода.\n*   **`dtype`: `bfloat16` (Оставить).** Стандартно.\n*   **`num_beams` (добавить/изменить):** Для T5-моделей beam search может помочь в поиске более качественных последовательностей. Попробуйте увеличить `num_beams` до 3 или 5. Это может увеличить время инференса, но потенциально улучшить качество генерации, если модель *уже* что-то генерирует. Однако, если она выдает `None`, это не поможет.\n*   **Проверить `pad_token_id`, `eos_token_id`:** Убедитесь, что они корректно настроены для модели T5Gemma. Неправильные токены могут приводить к обрывам или пустым ответам. Возможно, модель обрывает генерацию, потому что достигает `eos_token` слишком рано.\n*   **Дебаг `temperature` (временная мера):** Если модель по-прежнему не генерирует ничего, попробуйте временно установить `do_sample=true` и очень низкое `temperature` (например, 0.1-0.3) *только для отладки*, чтобы увидеть, сгенерирует ли она хоть что-то. Затем вернитесь к `do_sample=false`.\n\n---\n\n### 6. Общие рекомендации по улучшению качества\n\n1.  **Приоритет №1: Починить генерацию:**\n    *   **Проверить базовую функциональность:** Убедитесь, что модель вообще способна что-либо генерировать. Попробуйте подать простейший промпт, например, \"Привет, мир!\" и посмотрите на вывод.\n    *   **Отладка окружения:** Убедитесь, что процесс вызова `generate` и взаимодействие с библиотекой `transformers` настроены корректно и не возвращают `None` по ошибке. Возможно, проблема не в самой модели, а в обертке.\n    *   **Мониторинг ресурсов:** Убедитесь, что для модели достаточно VRAM и других вычислительных ресурсов.\n2.  **Дообучение (Fine-tuning):** Для столь специфичной и сложной задачи извлечения структурированных данных, **дообучение модели на наборе данных, специально созданном для этой задачи и формата вывода (JSON)**, будет наиболее эффективным решением.\n    *   Создайте качественный датасет из пар (входной текст, ожидаемый JSON-вывод).\n    *   Используйте этот датасет для дообучения `google/t5gemma-2-1b-1b` или другой подходящей модели.\n3.  **Использование более крупной модели:** `1b` модель может быть недостаточно мощной для решения такой сложной задачи. Если дообучение невозможно или не дает желаемых результатов, рассмотрите использование более крупных T5-подобных моделей (например, семейства T5, Flan-T5 XL/XXL, если они доступны для русского языка или хорошо работают на английском и могут быть адаптированы).\n4.  **Двухэтапный подход:**\n    *   **Этап 1 (Извлечение):** Используйте модель или регулярные выражения для извлечения сырых данных (например, \"N 7-9%\", \"стандарт ТУ...\"). На этом этапе не требуется строгий JSON.\n    *   **Этап 2 (Структурирование):** Затем используйте вторую, возможно, меньшую LLM или даже скрипт для преобразования этих сырых данных в требуемый JSON-формат. Это может упростить задачу для каждой модели.\n5.  **Использование RAG (Retrieval Augmented Generation):** Если часть данных (например, стандарты, марки) повторяется или может быть найдена в базе знаний, можно сначала использовать механизм поиска (retrieval) для извлечения релевантной информации, а затем передать ее LLM вместе с основным текстом.\n6.  **Уменьшение сложности промпта:** Если все вышеперечисленное не помогает, попробуйте начать с извлечения только одного типа данных (например, только массовой доли N), а затем постепенно добавлять новые требования. Это поможет изолировать источник проблемы.\n\nНачать следует с починки процесса генерации и завершения промпта, а также добавления few-shot примеров. Без этих шагов любая другая оптимизация будет бессмысленной.",
    "model_used": "gemini-2.5-flash"
  }
}