{
  "timestamp": "20260125_130310",
  "model_name": "Qwen/Qwen2.5-3B-Instruct",
  "interrupted": false,
  "processed_count": 100,
  "total_count": 100,
  "multi_agent_mode": null,
  "gpu_info": {
    "cuda_available": true,
    "cuda_version": "12.1",
    "gpu_name": "NVIDIA GeForce RTX 4060 Laptop GPU",
    "gpu_memory_total_gb": 8.0,
    "gpu_memory_allocated_gb": 0.0,
    "gpu_memory_reserved_gb": 0.0,
    "gpu_name_detailed": "NVIDIA GeForce RTX 4060 Laptop GPU",
    "driver_version": "591.74"
  },
  "gpu_memory_after_load_gb": 5.75,
  "gpu_memory_during_inference_gb": 5.76,
  "gpu_memory_during_inference_max_gb": 5.76,
  "gpu_memory_during_inference_min_gb": 5.76,
  "api_model": false,
  "average_response_time_seconds": 727.2739152383805,
  "parsing_error_rate": 0.19,
  "parsing_errors_count": 19,
  "quality_metrics": {
    "массовая доля": {
      "accuracy": 0.13203703703703704,
      "precision": 0.2484472049689441,
      "recall": 0.17777777777777778,
      "f1": 0.2072538860103627,
      "tp": 40,
      "fp": 121,
      "fn": 185,
      "ошибки": [
        "Вещество P2O5: предсказано [20.0, 1.0], истина [19.0, 21.0]",
        "Вещество K2O: предсказано [30.0, 1.0], истина [29.0, 31.0]",
        "Вещество N: предсказано [8.0, 1.0], истина [7.0, 9.0]",
        "Вещество P2O5: предсказано отсутствует, истина 10.0",
        "Вещество K2O: предсказано отсутствует, истина 10.0",
        "Вещество N: предсказано отсутствует, истина 20.0",
        "Вещество NH4+: предсказано [None, 0.5], истина отсутствует",
        "Вещество Ca: предсказано [32.0, None], истина отсутствует",
        "Вещество N: предсказано 17.0, истина отсутствует",
        "Вещество NH4+: предсказано отсутствует, истина [None, 0.5]"
      ]
    },
    "прочее": {
      "accuracy": 0.06663441134029369,
      "precision": 0.2127659574468085,
      "recall": 0.10050251256281408,
      "f1": 0.136518771331058,
      "tp": 20,
      "fp": 74,
      "fn": 179,
      "ошибки": [
        "Параметр марка: предсказано отсутствует, истина npks-8 (npk 8:20:30)",
        "Параметр масса брутто: предсказано отсутствует, истина 1050.0",
        "Параметр масса брутто единицы: предсказано 1050.0, истина отсутствует",
        "Параметр масса нетто: предсказано отсутствует, истина 1035000.0",
        "Параметр количество вагонов: предсказано отсутствует, истина 15.0",
        "Параметр стандарт: предсказано отсутствует, истина ту 2181-073-05761695-2016",
        "Параметр вес реквизита крепления: предсказано отсутствует, истина 1584.0",
        "Параметр масса брутто: предсказано отсутствует, истина 20640.0",
        "Параметр количество поддонов: предсказано отсутствует, истина 20.0",
        "Параметр количество мешков: предсказано отсутствует, истина 1000.0"
      ]
    }
  },
  "hyperparameters": {
    "max_new_tokens": 1024,
    "do_sample": false,
    "dtype": "bfloat16"
  },
  "prompt_template": "build_prompt3",
  "prompt_full_text": "\nТы — эксперт по извлечению численных и количественных характеристик из текстов о химических веществах и удобрениях.  \nТвоя задача:  \n\n1. Найти все численные признаки в тексте, например:  \n   - Массовую долю элементов (массовая доля N, массовая доля P2O5 и др.) в процентах.  \n   - Количество товара (кг, т, п/э мешки, вагон и др.).  \n   - Прочие численные показатели, указанные в тексте (марки, стандарты (ТУ, ГОСТ и др.), идентификаторы).  \n\n2. Выведи json по аналогии с этими примерами:\nТекст примера 1: СЛОЖНОЕ АЗОТНО-ФОСФОРНО-КАЛИЙНОЕ МИНЕРАЛЬНОЕ УДОБРЕНИЕ АЗОФОСКА (НИТРОАММОФОСКА), ГРАНУЛИРОВАННОЕ, С СОДЕРЖАНИЕМ МАССОВОЙ ДОЛИ АЗОТА 16 МАС.%, ФОСФОРА 16 МАС.%, КАЛИЯ 16 МАС.% В ПЕРЕСЧЕТЕ НА СУXОЙ БЕЗВОДНЫЙ ПРОДУКТ, СООТВЕТСТВУЕТ ТУ 2186-039-00203789 -2003, ОБЕСПЕЧИВАЕТ СБАЛАНСИРОВАННОЕ ПИТАНИЕ РАСТЕНИЙ В СЕЛЬСКОМ ХОЗЯЙСТВЕ, В ПОЛИПРОПИЛЕНОВЫХ МЕШКАХ ПО 50 КГ СЛОЖНОЕ АЗОТНО-ФОСФОРНО-КАЛИЙНОЕ МИНЕРАЛЬНОЕ УДОБРЕНИЕ АЗОФОСКА\nОтвет примера 1: \n{\n  \"массовая доля\": [\n    {\n      \"вещество\": \"N\",\n      \"массовая доля\": 16\n    },\n    {\n      \"вещество\": \"P2O5\",\n      \"массовая доля\": 16\n    },\n    {\n      \"вещество\": \"K2O\",\n      \"массовая доля\": 16\n    }\n  ],\n  \"прочее\": [\n    {\n      \"параметр\": \"стандарт\",\n      \"значение\": \"ТУ 2186-039-00203789-2003\"\n    },\n    {\n      \"параметр\": \"масса нетто единицы\",\n      \"масса\": 50,\n      \"единица\": \"кг\"\n    }\n  ]\n}\n\nТекст примера 2: СУЛЬФАТ КАЛИЯ, ДЛЯ ТЕХНИЧЕСКОГО ИСПОЛЬЗОВАНИЯ. КРИСТАЛЛИЧЕСКИЙ РАССЫПЧАТЫЙ ПОРОШОК БЕЛОГО ЦВЕТА С ЖЕЛТОВАТЫМ ОТТЕНКОМ, НЕ СОДЕРЖАЩИЙ МЕХАНИЧЕСКИХ ПРИМЕСЕЙ,УПАКОВАННЫЙ В БИГ-БЕГИ ПО 1000 КГ+5%. СОСТАВ: МАССОВАЯ ДОЛЯ КАЛИЯ (К2О)-50.0%,SO4 - 52,5% ХЛОР( CI)-1.0% ГИГРОСКОПИЧЕН. :\nОтвет примера 2: {\n  \"массовая доля\": [\n    {\n      \"вещество\": \"K2O\",\n      \"массовая доля\": 50.0\n    },\n    {\n      \"вещество\": \"SO4\",\n      \"массовая доля\": 52.5\n    },\n    {\n      \"вещество\": \"Cl\",\n      \"массовая доля\": 1.0\n    }\n  ],\n  \"прочее\": [\n    {\n      \"параметр\": \"масса брутто единицы\",\n      \"масса\": 1050,\n      \"единица\": \"кг\"\n    }\n  ]\n}\n\nТекст примера 3: НИТРАТ КАЛЬЦИЯ КОНЦЕНТРИРОВАННЫЙ.ГРАНУЛИРОВАННЫЙ ПРОДУКТ С СОДЕРЖ.МАС.ДОЛИ ОБЩЕГО АЗОТА 17%, АММОНИЙНОГО АЗОТА НЕ БОЛЕЕ 0,5%,КАЛЬЦИЯ НЕ МЕНЕЕ 32%.ПРИМ-СЯ В СЕЛЬСКОМ ХОЗЯЙСТВЕ,РОЗНИЧНОЙ ПРОДАЖЕ В КАЧЕСТВЕ МИНЕРАЛЬНОГО УДОБРЕНИЯ. :\nОтвет примера 3: \n{\n  \"массовая доля\": [\n    {\n      \"вещество\": \"N\",\n      \"массовая доля\": 17\n    },\n    {\n      \"вещество\": \"NH4+\",\n      \"массовая доля\": [null, 0.5]\n    },\n    {\n      \"вещество\": \"Ca\",\n      \"массовая доля\": [32, null]\n    }\n  ],\n  \"прочее\": []\n}\n\nТекст примера 4: КАЛИЙ СЕРНОКИСЛЫЙ ИЗ НЕФЕЛИНОВОГО СЫPЬЯ ТУ 20.15.52-089-05785164-2022, ПРЕДНАЗНАЧЕН ДЛЯ ПРИМЕНЕНИЯ В КАЧЕСТВЕ МИНЕРАЛЬНОГО УДОБРЕНИЯ В СЕЛЬСКОМ ХОЗЯЙСТВЕ, ПОЛУЧАЮТ ИЗ ВЕТВИ ТЕХНОЛОГИЧЕСКОГО ПРОЦЕССА ПРОИЗВОДСТВА СОДОПРОДУКТОВ ИЗ РАСТВОРОВ ГЛИНОЗЕМНОГО ПРОИЗВОДСТВА\nОтвет примера 4: \n{\n  \"массовая доля\": [],\n  \"прочее\": [\n    {\n      \"параметр\": \"стандарт\",\n      \"значение\": \"ТУ 20.15.52-089-05785164-2022\"\n    }\n  ]\n}\n\nТекст примера 5: СУЛЬФАТ КАЛИЯ (СОРТ ЭКСТРА), ДЛЯ ТЕХНИЧЕСКOГО ИСПОЛЬЗОВАНИЯ. КРИСТАЛЛИЧЕСКИЙ РАССЫПЧАТЫЙ ПОРОШОК БЕЛОГО ЦВЕТА С ЖЕЛТОВАТЫМ ОТТЕНКОМ, НЕ СОДЕРЖАЩИЙ МЕХАНИЧЕСКИХ ПРИМЕСЕЙ,УПАКОВАННЫЙ В МЕШКИ ПО 25КГ+-5%, ОБЩИЙ ВЕС БРУТТО С ПАЛЛЕТАМИ 21640 КГ. СОСТАВ:МА МАССОВАЯ ДОЛЯ КАЛИЯ (К2О)-51.0%,SO4 - 51,0% ХЛОР(CI)-1.0%, ГИГРОСКОПИЧЕН. :\nОтвет примера 5: \n{\n  \"массовая доля\": [\n    {\n      \"вещество\": \"K2O\",\n      \"массовая доля\": 51.0\n    },\n    {\n      \"вещество\": \"SO4\",\n      \"массовая доля\": 51.0\n    },\n    {\n      \"вещество\": \"Cl\",\n      \"массовая доля\": 1.0\n    }\n  ],\n  \"прочее\": [\n    {\n      \"параметр\": \"масса брутто единицы\",\n      \"масса\": 26.25,\n      \"единица\": \"кг\"\n    },\n    {\n      \"параметр\": \"масса брутто\",\n      \"масса\": 21640,\n      \"единица\": \"кг\"\n    }\n  ]\n}\n\n3. Выводи json результат **только после слова ОТВЕТ:**.\n\nТекст для анализа:\nКАЛИЙ СЕРНОКИСЛЫЙ ИЗ НЕФЕЛИНОВОГО СЫPЬЯ ТУ 20.15.52-089-05785164-2022, ПРЕДНАЗНАЧЕН ДЛЯ ПРИМЕНЕНИЯ В КАЧЕСТВЕ МИНЕРАЛЬНОГО УДОБРЕНИЯ В СЕЛЬСКОМ ХОЗЯЙСТВЕ, ПОЛУЧАЮТ ИЗ ВЕТВИ ТЕХНОЛОГИЧЕСКОГО ПРОЦЕССА ПРОИЗВОДСТВА СОДОПРОДУКТОВ ИЗ РАСТВОРОВ ГЛИНОЗЕМНОГО ПРОИЗВОДСТВА\n",
  "prompt_info": null,
  "parsing_errors": [
    {
      "text_index": 6,
      "text": "НИТРАТ КАЛЬЦИЯ КОНЦЕНТРИРОВАННЫЙ.ГРАНУЛИР-НЫЙ ПРОДУКТ С СОДЕРЖ.МАС.ДОЛИ ОБЩЕГО АЗОТА 17%, АММОНИЙНОГО АЗОТА НЕ БОЛЕЕ 0,5%,КАЛЬЦИЯ НЕ МЕНЕЕ 32%.ПРИМ-СЯ В С/Х,РОЗНИЧНОЙ ПРОДАЖЕ В КАЧЕСТВЕ МИНЕРАЛЬНОГО УДОБРЕНИЯ.ВЕС РЕКВИЗИТА КРЕПЛЕНИЯ 1584 КГ :",
      "error": "Невалидный JSON. Ответ: {\n  \"",
      "response": "{\n  \""
    },
    {
      "text_index": 8,
      "text": "УДОБРЕНИЕ МИНЕРАЛЬНОЕ NP(S) 20:20(14), АЗОТНО-ФОСФОРНОЕ, СЕРОСОДЕРЖАЩЕЕ. МАССОВАЯ ДОЛЯ ОБЩЕГО АЗОТА - 20+/-1%; МАССОВАЯ ДОЛЯ ФОСФАТОВ (P2O5), РАСТВОРИМЫX В РАСТВОРЕ ЦИТРАТА АММОНИЯ - 20+/-1%; МАССОВАЯ ДОЛЯ СУЛЬФАТНОЙ СЕРЫ В ПЕРЕСЧЕТЕ НА S - 14+/-1%. 1%. :",
      "error": "Невалидный JSON. Ответ: {\n  \"м",
      "response": "{\n  \"м"
    },
    {
      "text_index": 14,
      "text": "ЖИДКОЕ KОМПЛЕКСНОЕ УДОБРЕНИЕ 11:37 (РАСТВОР ПОЛИФОСФАТА АММОНИЯ), СОДЕРЖАЩЕЕ АЗОТ И ФОСФОР. МАССОВАЯ ДОЛЯ АММОНИЙНОГО АЗОТА (N) - НЕ МЕНЕЕ 11%; МАССОВАЯ ДОЛЯ ОБЩИХ ФОСФАТОВ (P2O5) - НЕ МЕНЕЕ 37%.. :",
      "error": "Невалидный JSON. Ответ: {\n      \"вещество\": \"P2O5\",\n      \"массовая д",
      "response": "{\n      \"вещество\": \"P2O5\",\n      \"массовая д"
    },
    {
      "text_index": 15,
      "text": "АЗОФОСКА.СЛОЖНОЕ АЗОТНО-ФОСФОРНО-КАЛИЙНОЕ УДОБРЕНИЕ.ГРАНУЛИРОВАННЫЙ ПРОДУКТ БЕЗ МЕХАНИЧ.ПРИМЕСЕЙ С СОДЕРЖАНИЕМ МАССОВОЙ ДОЛИ АЗОТА 27%,ФОСФОРА НЕ МЕНЕЕ 6%,КАЛИЯ НЕ МЕНЕЕ 6%,СУЛЬФАТОВ НЕ МЕНЕЕ 2%.. :",
      "error": "Невалидный JSON. Ответ: {\n  \"массовая",
      "response": "{\n  \"массовая"
    },
    {
      "text_index": 18,
      "text": "СУЛЬФАТ КАЛИЯ, ДЛЯ ТЕХНИЧЕСКОГО ИСПОЛЬЗОВАНИЯ. КРИСТАЛЛИЧЕСКИЙ РАССЫПЧАТЫЙ ПОРОШОК БЕЛОГО ЦВЕТА С ЖЕЛТОВАТЫМ ОТТЕНКОМ, НЕ СОДЕРЖАЩИЙ МЕХАНИЧЕСКИХ ПРИМЕСЕЙ,УПАКОВАННЫЙ В БИГ-БЕГИ ПО 1000 КГ+5%, ОБЩИЙ ВЕС БРУТТО С ПАЛЛЕТАМИ 20980 КГ. СОСТАВ: МАССОВАЯДО ДОЛЯ КАЛИЯ (К2О)-50.0%,SO4 - 51,0% ХЛОР(CI)-1.0%, ГИГРОСКОПИЧЕН. :",
      "error": "Невалидный JSON. Ответ: {\n      \"вещество\": \"K2O\",\n      \"масс",
      "response": "{\n      \"вещество\": \"K2O\",\n      \"масс"
    },
    {
      "text_index": 22,
      "text": "МОНОКАЛИЙФОСФАТ АГРОХИМИКАТ УПАКОВАНО В 1100 МЕШКОВ ПО 25 КГ НА 22 ДЕРЕВЯННЫХ ПОДДОНАХ. ВЕС ПОДДОНОВ 572 КГ.. МОНОКАЛИЙФОСФАТ АГРОХИМИКАТ",
      "error": "Невалидный JSON. Ответ: {\n      \"параметр\": \"вес поддонов\",\n      \"значение",
      "response": "{\n      \"параметр\": \"вес поддонов\",\n      \"значение"
    },
    {
      "text_index": 46,
      "text": "СУЛЬФАТ АММОНИЯ КРИСТАЛЛИЧЕСКИЙ (УДОБРЕНИЕ), ТУ 2181-073-05761695-2016, 22000.00.КГ НЕ ДЛЯ ВОЕННОГО ПРИМЕНЕНИЯ. СУЛЬФАТ АММОНИЯ КРИСТАЛЛИЧЕСКИЙ (УДОБРЕНИЕ),",
      "error": "Невалидный JSON. Ответ: СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ АММОНИЙНОГО АЗОТА 22.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ КАЛИЯ 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОДА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МА",
      "response": "СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ АММОНИЙНОГО АЗОТА 22.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ КАЛИЯ 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОДА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.0"
    },
    {
      "text_index": 59,
      "text": "НИТРОАММОФОСКА (АЗОФОСКА), УДОБРЕНИЕ МИHЕРАЛЬНОЕ , СОДЕРЖАЩЕЕ ТРИ ПИТАТЕЛЬНЫХ ЭЛЕМЕНТА - АЗОТ-16%, ФОСФОР-16%,КАЛИЙ-16% В МЕШКАХ ПО 50 КГ. :",
      "error": "Невалидный JSON. Ответ: [],\n  \"прочее",
      "response": "[],\n  \"прочее"
    },
    {
      "text_index": 60,
      "text": "НИТРОАММОФОСКА. СЛОЖНОЕ НЕОРГАНИЧЕСКОЕ АЗОТНО-ФОСФОРНО(ФОСФАТНО)-КАЛИЙНОЕ УДОБРЕНИЕ, ПРЕДНАЗНАЧЕННОЕ ДЛЯ ПРИМЕНЕНИЯ В КАЧЕСТВЕ МИНЕРАЛЬНОГО УДОБРЕНИЯ В СЕЛЬСКОМ И ЛИЧНОМ ПОДСОБНОМ ХОЗЯЙСТВАХ. МАССОВАЯ ДОЛЯ, НЕ МЕНЕЕ: ОБЩЕГО АЗОТА - 16%; ОБЩИХ ФОСФАТОВ - 16%; КАЛИЯ В ПЕРЕСЧЁТЕ НА К2О - 16%.",
      "error": "Невалидный JSON. Ответ: {\n      \"параметр\": \"масса нетто единицы\",\n      \"",
      "response": "{\n      \"параметр\": \"масса нетто единицы\",\n      \""
    },
    {
      "text_index": 62,
      "text": "СУЛЬФАТ АМMОНИЯ, НАСЫПЬЮ. ВНЕШНИЙ ВИД: БЕЛЫЕ ИЛИ ПРОЗРАЧНЫЕ КРИСТАЛЛЫ. МАССОВАЯ ДОЛЯ АЗОТА В ПЕРЕСЧЕТЕ НА СУХОЕ ВЕЩЕСТВО: 21%. ИСПОЛЬЗУЕТСЯ В СЕЛЬСКОМ ХОЗЯЙСТВЕ В КАЧЕСТВЕ АЗОТНОГО УДОБРЕНИЯ.. :",
      "error": "Невалидный JSON. Ответ: [",
      "response": "["
    },
    {
      "text_index": 63,
      "text": "НИТРАТ КАЛЬЦИЯ КОНЦЕНТРИРОВАННЫЙ. ГРАНУЛИРОВАННЫЙ ПРОДУКТ БЕЛ.ЦВЕТА С СОД.МАС.ДОЛИ ОБЩ.АЗОТА 17%, АММОНИЙНОГО АЗОТА НЕ БОЛ.0,5%,КАЛЬЦИЯ НЕ МЕН.32%. ПРИМ-СЯ В С/Х, В РОЗН.ПРОДАЖE В КАЧ.МИН.УДОБРЕНИЯ.. :",
      "error": "Невалидный JSON. Ответ: {\n      \"вещество",
      "response": "{\n      \"вещество"
    },
    {
      "text_index": 65,
      "text": "ОРГАНИЧЕСКОЕ УДОБРЕНИЕ РАСТИТЕЛЬНОГО ПРОИСХОЖДЕНИЯ НА ОСНОВЕ ГУМИНОВЫХ И ФУЛЬВОВЫХ КИСЛОТ ПРИРОДНОГО (РАСТИТЕЛЬНОГО) ПРОИСХОЖДЕНИЯ, СРЕДСТВО ДЛЯ АГРОТЕХНИЧЕСКОЙ ОБРАБОТКИ СЕМЯН И РАССАДЫ.. ПРЕДНАЗНАЧЕНО ДЛЯ ПОВЫШЕНИЯ ПЛОДОРОДИЯ ПОЧВ, УРОЖАЙНОСТИ, КАЧЕСТВА И ЧИСТОТЫ ПРОДУКЦИИ РАСТЕНИЕВОДСТВА, БЕЗ СПИРТА, НЕ ОТХОДЫ, НЕ ДЛЯ ВЕТЕРИНАРИИ.РАСФАСОВАНО В ПЛАСТИКОВЫЕ БУТЫЛКИ. ЦИТОГУМАТ, МАРКА Б (УНИВЕРСАЛЬНЫЙ) 1 Л (БУТЫЛКА)",
      "error": "Невалидный JSON. Ответ: {\n  \"масс",
      "response": "{\n  \"масс"
    },
    {
      "text_index": 68,
      "text": "НИТРОАММОФОСКА (АЗОФОСКА), УДОБРЕНИЕ МИНЕРАЛЬНОЕ , СОДЕРЖАЩЕЕ ДВА ПИТАТЕЛЬНЫХ ЭЛЕМЕНТА - АЗОТ-20%,ФОСФОР-20%, В МКР ПО 1000 КГ. :",
      "error": "Невалидный JSON. Ответ: [",
      "response": "["
    },
    {
      "text_index": 69,
      "text": "АММОНИЙ КАЛЬЦИЙ НИТРАТ (ДВОЙНЫЕ СOЛИ И СМЕСИ НИТРАТА КАЛЬЦИЯ И НИТРАТА АММОНИЯ),АГРОХИМИКАТ, МАССОВАЯ ДОЛЯ ОБЩЕГО АЗОТА 15.5%, В МЕШКАХ ПО 25 КГ, УЛОЖЕННЫЕ НА ПОДДОНЫ ,ЗАКРЕПЛЕННЫЕ СВЕРХУ ТЕРМОУСАДОЧНОЙ ПЛЕНКОЙ . ВЕС ПОДДОНА 18 КГ., ОБЩИЙ ВЕС БРУТТО ОРИЕНТИРОВОЧНО 597888 КГ. :",
      "error": "Невалидный JSON. Ответ: {\n      \"вещ",
      "response": "{\n      \"вещ"
    },
    {
      "text_index": 71,
      "text": "НАТРИЙ АЗОТНОКИСЛЫЙ (НИТРАТ НАТРИЯ) Ч, ПРОЗРАЧНЫЕ БЕСЦВЕТНЫЕ КРИСТАЛЛЫ ИЛИ КРИСТАЛЛИЧЕСКИЙ ПОРОШОК БЕЛОГО ЦВЕТА, СОДЕРЖАНИЕ ОСН.ВЕЩ-ВА НЕ МЕНЕЕ 99,8% (ФАКТИЧ;СОДЕРЖ;99.81%), 40 П/П МЕШКОВ ПО 25 КГ, ВЕС БРУТТО С ПОДДОНОМ 1024 КГ, ГОСТ 4168-79, ИЗМ.1 , НЕ ЯВЛЯЕТСЯ УДОБРЕНИЕМ, ИСП. КАК РЕАКТИВ В ПИЩЕВОЙ, МЕТАЛЛООБРАБАТЫВАЮЩЕЙ, СТЕКОЛЬНОЙ ПРОМ-СТИ :",
      "error": "Невалидный JSON. Ответ: {\n      \"параметр\": \"количество товара\",\n      \"количество\": 40,\n      \"единица\": \"п/п мешков\"\n    }\n  ]\n} Напоминаю, что ответ должен быть в формате JSON и соответствовать заданию. В данном случае, в",
      "response": "{\n      \"параметр\": \"количество товара\",\n      \"количество\": 40,\n      \"единица\": \"п/п мешков\"\n    }\n  ]\n} Напоминаю, что ответ должен быть в формате JSON и соответствовать заданию. В данном случае, в тексте присутствуют только массовая доля вещества (99,8%) и количество товара (40 п/п мешков по 25 кг), но нет других численных характеристик. Поэтому массовая доля не указана, а прочее содержание представлено стандартом, массой брутто единицы и количеством товара. \n\nЕсли у вас есть другие тексты д"
    },
    {
      "text_index": 75,
      "text": "УДОБРЕHИЯ МИНЕРАЛЬНЫЕ ИЛИ ХИМИЧЕСКИЕ, СОДЕРЖАЩИЕ ТРИ ПИТАТЕЛЬНЫХ ЭЛЕМЕНТА: АЗОТ, ФОСФОР, КАЛИЙ. УДОБРЕНИЕ АЗОТНО-ФОСФОРНО-КАЛИЙНОЕ МАРКА NPK-1 (ДИАММОФОСКА) 10:26:26, МАССОВАЯ ДОЛЯ N-10+/-1%, Р2О5-26+/-1%, К2О-26+/-1%, ВНЕШНИЙ ВИД: ГРАНУЛИРОВАННЫЙ ПРОДУКТ ОТ БЕЛОГО ДО СЕРОГО ИЛИ РОЗОВОГО ЦВЕТА С РАЗЛИЧНЫМИ ОТТЕНКАМИ, БЕЗ УПАКОВКИ",
      "error": "Невалидный JSON. Ответ: {\n      \"параметр\": \"масса нетто единицы\",\n      \"масс",
      "response": "{\n      \"параметр\": \"масса нетто единицы\",\n      \"масс"
    },
    {
      "text_index": 84,
      "text": "СЕЛИТРА ИЗВЕСТКОВО-АММИАЧНАЯ ГРАНУЛИРОВАННАЯ. МИН.УДОБРЕНИЕ.ДВУХКОМПОНЕНТНЫЙ ПРОДУКТ БЕЛОГО ЦВЕТА С СОДЕРЖАНИЕМ МАС.ДОЛИ АЗОТА В СУХОМ ВЕЩ-ВЕ 27%, МАС.ДОЛИ УГЛЕКИСЛОГО КАЛЬЦИЯ 20%, КОТОРЫЙ ЯВЛ. РАСКИСЛИТЕЛЕМ И НЕ ЯВЛ.МИН.УДОБРЕНИЕМ :",
      "error": "Невалидный JSON. Ответ: {\n      \"параметр\": \"масса брутто единицы\",\n      \"м",
      "response": "{\n      \"параметр\": \"масса брутто единицы\",\n      \"м"
    },
    {
      "text_index": 93,
      "text": "СУЛЬФАТ КАЛИЯ, ДЛЯ ТЕХНИЧЕСКОГО ИСПОЛЬЗОВАНИЯ:КРИСТАЛЛИЧЕСКИЙ РАССЫПЧАТЫЙ ПОРОШОК БЕЛОГО ЦВЕТА С ЖЕЛТОВАТЫМ ОТТЕНКОМ, НЕ СОДЕРЖАЩИЙ МЕХАНИЧЕСКИХ ПРИМЕСЕЙ,УПАКОВАННЫЙ В БИГ-БЕГИ ПО 1000 КГ+5%:СОСТАВ: МАССОВАЯ ДОЛЯ КАЛИЯ (К2О)-50.0%,SO4 - 52,5% ХЛОР( CI)-1.0% ГИГРОСКОПИЧЕН. :",
      "error": "Невалидный JSON. Ответ: []\n}\n```",
      "response": "[]\n}\n```"
    },
    {
      "text_index": 98,
      "text": "АГPОХИМИКАТ МОНОКАЛИЙФОСФАТ. УПАКОВАНО В 840 МЕШКОВ ПО 25 КГ НА 21 ДЕРЕВЯННЫХ ПОДДОНАХ. ВЕС ПОДДОНОВ 546 КГ.. МОНОКАЛИЙФОСФАТ АГРОХИМИКАТ",
      "error": "Невалидный JSON. Ответ: {\n      \"параметр\": \"упаковка\",\n      \"значение",
      "response": "{\n      \"параметр\": \"упаковка\",\n      \"значение"
    }
  ],
  "total_samples": 100,
  "valid_json_count": 81,
  "invalid_json_count": 19,
  "gemini_analysis": {
    "status": "success",
    "analysis": "## Оценка качества работы модели Qwen/Qwen2.5-3B-Instruct\n\n**Общая оценка:**\nМодель Qwen/Qwen2.5-3B-Instruct показала крайне неудовлетворительные результаты для данной задачи извлечения структурированных данных в формате JSON. Метрики качества (F1 20.73% для \"Массовой доли\" и 13.65% для \"Прочего\") сигнализируют о серьезных проблемах. Главная и наиболее критичная проблема — это систематическое нарушение формата JSON, которое делает дальнейшую обработку ответов модели невозможной.\n\n### 1. Характерные ошибки модели\n\nОсновная и подавляющая ошибка – **неспособность генерировать валидный JSON**. Из 19 приведенных ошибок, все 19 являются ошибками \"Невалидный JSON\".\n\n*   **Трассировка/Обрыв JSON:** Модель часто начинает JSON-объект (`{`) или массив (`[`), но затем обрывает его, не завершая структуру. Примеры: `{`, `{ \"м`, `{\"массовая`, `{ \"вещество\": \"P2O5\", \"массовая д`.\n*   **Генерация нерелевантного текста:** В некоторых случаях модель полностью игнорирует требование к JSON и генерирует обычный текст, который, возможно, является попыткой извлечения данных, но вне требуемого формата. Пример: `СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ АММОНИЙНОГО АЗОТА...` (Текст #46).\n*   **Игнорирование инструкции \"ОТВЕТ:\":** Модель не всегда помещает свой вывод после слова \"ОТВЕТ:\", что свидетельствует о нарушении даже простых инструкций промпта.\n\n### 2. Причины ошибок парсинга JSON\n\nОсновной причиной ошибок парсинга является то, что модель **не генерирует полноценный и синтаксически корректный JSON**. Это не ошибка парсера, это ошибка генерации со стороны модели.\n\n*   **Ограниченная мощность модели (Model Capability):** Qwen2.5-3B-Instruct — это относительно небольшая модель (3 миллиарда параметров). Генерация сложных, строго структурированных ответов, таких как JSON, особенно с учетом нескольких примеров и длинного промпта, является сложной задачей для моделей такого размера. Меньшие модели часто испытывают трудности с поддержанием последовательной структуры на протяжении всего ответа.\n*   **Перегрузка инструкциями/контекстом:** Хотя промпт очень хорошо составлен и содержит много примеров (что обычно полезно), для 3B модели такой объем инструкций и 5 примеров может быть избыточным. Модель может \"забывать\" или не полностью усваивать требование к *полной* JSON-структуре, фокусируясь на извлечении отдельных элементов.\n*   **Отсутствие \"сигнала завершения\":** Модель, кажется, не имеет четкого внутреннего механизма, чтобы определить, когда JSON должен быть закрыт и как его правильно завершить. Она просто прерывает генерацию.\n\n### 3. Причины ошибок в извлечении данных\n\nНевозможно адекватно оценить ошибки в извлечении данных, когда сам формат JSON нарушен. Если модель не может сформировать валидный JSON, она не может корректно представить извлеченные данные.\n\n*   **Корень проблемы в JSON-формате:** Вероятно, низкие метрики извлечения данных напрямую связаны с неспособностью модели выдавать валидный JSON. Если бы JSON был корректным, возможно, модель бы показала более высокие результаты по извлечению.\n*   **Пример 4 (тестовый текст):** Текст для анализа `КАЛИЙ СЕРНОКИСЛЫЙ ИЗ НЕФЕЛИНОВОГО СЫPЬЯ ТУ 20.15.52-089-05785164-2022...` идентичен \"Тексту примера 4\". Ожидаемый JSON для него:\n    ```json\n    {\n      \"массовая доля\": [],\n      \"прочее\": [\n        {\n          \"параметр\": \"стандарт\",\n          \"значение\": \"ТУ 20.15.52-089-05785164-2022\"\n        }\n      ]\n    }\n    ```\n    Если модель не может воспроизвести даже этот простой, прямо указанный пример, это подтверждает, что проблема не в сложности извлечения, а в генерации *формата*.\n\n### 4. Рекомендации по улучшению промпта\n\nПромпт сам по себе очень хорош с точки зрения детализации и примеров, но его можно адаптировать для снижения нагрузки на небольшую модель и улучшения следования инструкциям:\n\n1.  **Уменьшить количество примеров:** 5 примеров могут быть слишком много для 3B модели. Попробуйте сократить до 2-3 наиболее репрезентативных и разнообразных примеров. Это может помочь модели лучше сфокусироваться на инструкциях, а не на многочисленных паттернах примеров.\n2.  **Усилить требование к валидному JSON:**\n    *   Добавить фразу: \"Твой ответ должен быть **полностью завершенным и синтаксически валидным JSON-объектом**.\"\n    *   В конце промпта, непосредственно перед \"Текст для анализа:\", добавить напоминание: \"Важно: **строго следуй формату JSON и выводи его только после слова ОТВЕТ:**\"\n3.  **Использовать маркеры для \"ОТВЕТ:\":** Вместо просто \"ОТВЕТ:\", можно попробовать:\n    ```\n    --- ОТВЕТ ---\n    {\n      ...\n    }\n    ```\n    Или:\n    ```\n    ### НАЧАЛО ОТВЕТА JSON\n    {\n      ...\n    }\n    ### КОНЕЦ ОТВЕТА JSON\n    ```\n    Это может помочь модели лучше определить начало и конец требуемого формата.\n4.  **Упростить специфичные кейсы (по возможности):** Например, `[null, 0.5]` или `[32, null]` для \"не более/не менее\". Хотя это корректно, иногда для моделей сложнее генерировать структуры с `null`. Можно рассмотреть `{\"min\": 32, \"max\": null}` или `{\"min\": null, \"max\": 0.5}`, но это изменение будет менее приоритетным, чем обеспечение общего JSON-формата.\n\n### 5. Рекомендации по настройке гиперпараметров\n\nТекущие гиперпараметры подходят для задачи структурированного извлечения:\n\n*   `max_new_tokens=1024`: Достаточное количество токенов для вывода JSON.\n*   `do_sample=false`: Детерминированный вывод важен для точности извлечения данных.\n*   `dtype=bfloat16`: Стандартный тип данных.\n\n**Дополнительных рекомендаций по изменению этих гиперпараметров нет.** Они не являются причиной текущих проблем с валидностью JSON.\n\nЕсли бы `do_sample` был `true`, то было бы важно установить `temperature` на очень низкое значение (например, 0.1-0.3), чтобы уменьшить случайность и повысить шансы на генерацию структурированного вывода. Однако, поскольку `do_sample=false`, температура не влияет.\n\n### 6. Общие рекомендации по улучшению качества\n\n1.  **Смена модели (наиболее критично):** **Главная и самая важная рекомендация.** Qwen2.5-3B-Instruct, судя по результатам, недостаточно мощна для данной задачи. Для надежного извлечения структурированных данных в JSON-формате рекомендуется использовать значительно более крупные и/или более специализированные модели.\n    *   **Попробуйте более крупные instruct-модели:** Qwen2.5-7B-Instruct, Mixtral-8x7B-Instruct, Llama-3-8B-Instruct (или их аналоги). Эти модели значительно лучше справляются с генерацией структурированного вывода и следованием инструкциям.\n    *   **Рассмотрите модели, специально обученные для функций/JSON:** Некоторые модели или их версии оптимизированы для генерации JSON или вызова функций, что включает в себя выдачу структурированных ответов.\n2.  **Файн-тюнинг (Fine-tuning):** Если задача критически важна, а данные для обучения доступны в больших объемах, файн-тюнинг более крупной базовой модели (или даже instruct-модели) на вашем конкретном наборе данных с желаемым JSON-форматом даст наилучшие результаты. Это позволит модели \"выучить\" специфику вашего домена и целевого формата.\n3.  **Пост-обработка и валидация:**\n    *   **Внедрить строгую валидацию JSON:** После получения ответа от модели *всегда* пытайтесь распарсить его как JSON.\n    *   **Механизмы восстановления:** Если JSON невалиден:\n        *   **Логирование:** Фиксируйте все ошибки валидации для анализа.\n        *   **Автоматическое исправление (для мелких ошибок):** Для простых случаев (например, отсутствующая запятая, лишняя скобка в конце) можно попытаться программно исправить JSON.\n        *   **Повторный запрос (Retry Logic):** В некоторых случаях можно отправить невалидный ответ обратно модели с инструкцией \"Твой предыдущий ответ был невалидным JSON. Пожалуйста, исправь его и выдай корректный JSON.\" (потребует больше токенов и времени).\n        *   **Человеческая интервенция:** Для сложных ошибок, которые невозможно исправить автоматически, может потребоваться ручная корректировка.\n\nТаким образом, ключ к решению проблемы лежит в использовании более мощной языковой модели, способной надежно генерировать сложный структурированный вывод.",
    "model_used": "gemini-2.5-flash"
  },
  "ошибки": {
    "примеры_текстов": [
      {
        "text_index": 6,
        "text": "НИТРАТ КАЛЬЦИЯ КОНЦЕНТРИРОВАННЫЙ.ГРАНУЛИР-НЫЙ ПРОДУКТ С СОДЕРЖ.МАС.ДОЛИ ОБЩЕГО АЗОТА 17%, АММОНИЙНОГО АЗОТА НЕ БОЛЕЕ 0,5%,КАЛЬЦИЯ НЕ МЕНЕЕ 32%.ПРИМ-СЯ В С/Х,РОЗНИЧНОЙ ПРОДАЖЕ В КАЧЕСТВЕ МИНЕРАЛЬНОГО УДОБРЕНИЯ.ВЕС РЕКВИЗИТА КРЕПЛЕНИЯ 1584 КГ :",
        "error": "Невалидный JSON. Ответ: {\n  \"",
        "response": "{\n  \""
      },
      {
        "text_index": 8,
        "text": "УДОБРЕНИЕ МИНЕРАЛЬНОЕ NP(S) 20:20(14), АЗОТНО-ФОСФОРНОЕ, СЕРОСОДЕРЖАЩЕЕ. МАССОВАЯ ДОЛЯ ОБЩЕГО АЗОТА - 20+/-1%; МАССОВАЯ ДОЛЯ ФОСФАТОВ (P2O5), РАСТВОРИМЫX В РАСТВОРЕ ЦИТРАТА АММОНИЯ - 20+/-1%; МАССОВАЯ ДОЛЯ СУЛЬФАТНОЙ СЕРЫ В ПЕРЕСЧЕТЕ НА S - 14+/-1%. 1%. :",
        "error": "Невалидный JSON. Ответ: {\n  \"м",
        "response": "{\n  \"м"
      },
      {
        "text_index": 14,
        "text": "ЖИДКОЕ KОМПЛЕКСНОЕ УДОБРЕНИЕ 11:37 (РАСТВОР ПОЛИФОСФАТА АММОНИЯ), СОДЕРЖАЩЕЕ АЗОТ И ФОСФОР. МАССОВАЯ ДОЛЯ АММОНИЙНОГО АЗОТА (N) - НЕ МЕНЕЕ 11%; МАССОВАЯ ДОЛЯ ОБЩИХ ФОСФАТОВ (P2O5) - НЕ МЕНЕЕ 37%.. :",
        "error": "Невалидный JSON. Ответ: {\n      \"вещество\": \"P2O5\",\n      \"массовая д",
        "response": "{\n      \"вещество\": \"P2O5\",\n      \"массовая д"
      }
    ],
    "список_ошибок": [
      {
        "text_index": 6,
        "error": "Невалидный JSON. Ответ: {\n  \""
      },
      {
        "text_index": 8,
        "error": "Невалидный JSON. Ответ: {\n  \"м"
      },
      {
        "text_index": 14,
        "error": "Невалидный JSON. Ответ: {\n      \"вещество\": \"P2O5\",\n      \"массовая д"
      },
      {
        "text_index": 15,
        "error": "Невалидный JSON. Ответ: {\n  \"массовая"
      },
      {
        "text_index": 18,
        "error": "Невалидный JSON. Ответ: {\n      \"вещество\": \"K2O\",\n      \"масс"
      },
      {
        "text_index": 22,
        "error": "Невалидный JSON. Ответ: {\n      \"параметр\": \"вес поддонов\",\n      \"значение"
      },
      {
        "text_index": 46,
        "error": "Невалидный JSON. Ответ: СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ АММОНИЙНОГО АЗОТА 22.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ КАЛИЯ 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОДА 0.00 МАС.%, СОДЕРЖАЩИЙ МАССОВОЙ ДОЛИ СОЛЬФЕТА 0.00 МАС.%, СОДЕРЖАЩИЙ МА"
      },
      {
        "text_index": 59,
        "error": "Невалидный JSON. Ответ: [],\n  \"прочее"
      },
      {
        "text_index": 60,
        "error": "Невалидный JSON. Ответ: {\n      \"параметр\": \"масса нетто единицы\",\n      \""
      },
      {
        "text_index": 62,
        "error": "Невалидный JSON. Ответ: ["
      }
    ]
  }
}