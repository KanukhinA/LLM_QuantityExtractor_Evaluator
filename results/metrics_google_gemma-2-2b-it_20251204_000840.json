{
  "timestamp": "20251204_000840",
  "model_name": "google/gemma-2-2b-it",
  "gpu_info": {
    "cuda_available": true,
    "cuda_version": "12.1",
    "gpu_name": "NVIDIA GeForce RTX 4060 Laptop GPU",
    "gpu_memory_total_gb": 8.0,
    "gpu_memory_allocated_gb": 0.0,
    "gpu_memory_reserved_gb": 0.0,
    "gpu_name_detailed": "NVIDIA GeForce RTX 4060 Laptop GPU",
    "driver_version": "581.57"
  },
  "gpu_memory_after_load_gb": 4.87,
  "gpu_memory_during_inference_gb": 4.88,
  "gpu_memory_during_inference_max_gb": 4.88,
  "gpu_memory_during_inference_min_gb": 4.88,
  "average_response_time_seconds": 26.784600729942323,
  "parsing_error_rate": 0.22,
  "parsing_errors_count": 22,
  "quality_metrics": {
    "массовая доля": {
      "средняя_точность": 0.0671875,
      "precision": 0.08664259927797834,
      "recall": 0.1509433962264151,
      "f1": 0.11009174311926606,
      "tp": 24,
      "fp": 253,
      "fn": 135,
      "количество_сравнений": 96,
      "ошибки": [
        "Вещество NH4+: предсказано [None, 2.0], истина отсутствует",
        "Вещество K2O: предсказано 30.0, истина [29.0, 31.0]",
        "Вещество P2O5: предсказано [20.0, 22.0], истина [19.0, 21.0]",
        "Вещество S: предсказано [2.0, 2.0], истина [2.0, None]",
        "Вещество N: предсказано [8.0, 10.0], истина [7.0, 9.0]",
        "Вещество NH4+: предсказано [None, 2.0], истина отсутствует",
        "Вещество K2O: предсказано 20.0, истина 10.0",
        "Вещество P2O5: предсказано [20.0, None], истина 10.0",
        "Вещество S: предсказано 3.0, истина отсутствует",
        "Вещество N: предсказано [26.0, 28.0], истина 20.0"
      ]
    },
    "прочее": {
      "средняя_точность": 0.11434545144222565,
      "precision": 0.15538847117794485,
      "recall": 0.3583815028901734,
      "f1": 0.21678321678321674,
      "tp": 62,
      "fp": 337,
      "fn": 111,
      "количество_сравнений": 93,
      "ошибки": [
        "Параметр марка: предсказано n7-p20-k30-s3, истина отсутствует",
        "Параметр масса брутто: предсказано 1000.0, истина отсутствует",
        "Параметр масса нетто: предсказано 1000.0, истина отсутствует",
        "Параметр масса брутто: предсказано 1020.0, истина отсутствует",
        "Параметр объем нетто единицы: предсказано 10.0, истина отсутствует",
        "Параметр количество поддонов: предсказано 20.0, истина отсутствует",
        "Параметр масса нетто единицы: предсказано 50.0, истина отсутствует",
        "Параметр количество мешков: предсказано 1000.0, истина отсутствует",
        "Параметр марка: предсказано npks-8, истина npks-8 (npk 8:20:30)",
        "Параметр масса нетто: предсказано 950.0, истина отсутствует"
      ]
    }
  },
  "hyperparameters": {
    "max_new_tokens": 512,
    "do_sample": false,
    "torch_dtype": "bfloat16"
  },
  "prompt_template": "build_prompt3",
  "prompt_full_text": "\nТы — эксперт по извлечению численных и количественных характеристик из текстов о химических веществах и удобрениях.  \nТвоя задача:  \n\n1. Найти все численные признаки в тексте, например:  \n   - Массовую долю элементов (массовая доля N, массовая доля P2O5 и др.) в процентах.  \n   - Количество товара (кг, т, п/э мешки, вагон и др.).  \n   - Прочие численные показатели, указанные в тексте (марки, стандарты (ТУ, ГОСТ и др.), идентификаторы).  \n\n2. Для каждого численного признака определить:  \n   - Название признака (например, \"массовая доля N\", \"массовая доля P2O5\", \"массовая доля К2О\", \"массовая доля S\", \"масса нетто единицы\", \"масса нетто\", \"масса K2O\", \"масса брутто\", \"количество вагонов\", \"стандарт\" и т.д.)  \n   - Значение (число, если есть диапазон — брать оба значения; для стандарта указываешь полный номер стандарта со словами ГОСТ/ТУ или др.)  \n   - Единицу измерения (%, кг, т, шт, п/э меш, вагон, или пусто для стандарта)  \n\n3. Особые указания:\n   - Извлекай на русском\n   - Если признак указан как диапазон из нескольких чисел (например \"8-10\", или \"от 6 до 12\") или с погрешностью (+/-), укажи оба числа в формате [min, max]. \n   - Извлекай логические/сравнительные операторы, если они присутствуют в тексте: «не менее» - [min, null] «не более» - [null, max]\n   - Используй точку в качестве разделителя десятичных чисел.\n   - Название вещества и его массовая доля могут встречаться в марке (например, \"N7-P20-K30-S3\"),  используй данные из марки, если нет иных данных по массовой доле вещества.\n   - Если в названии признака есть название химического элемента (например Кальций) - замени его на обозначение химического элемента - Ca.\n   - Названия признаков пиши с маленькой буквы. Например \"массовая доля Zn\".\n   - Если указано например \"МАССОВАЯ ДОЛЯ K В ПЕРЕСЧЕТЕ НА К2О\" - то правильным извлекаемым признаком будет \"массовая доля K2O\".\n   - Если один и тот же параметр встречается дважды — сначала как общее условие (например, «с содержанием азота более 10%»), а затем как конкретное значение (например, «азот 16%»), указывай только конкретное значение.\n   - Для массы с упаковкой - называй признак \"масса брутто\" вне зависимости от наименования упаковки. Если указывается просто масса в формате \"МЕШКИ ПО 50 КГ\" - это признак \"масса нетто\".\n   - Если дается масса в виде \"ПО 1000 КГ+5%\" - указывай в признаке \"масса брутто\" одно значение - 1050.\n   - Для прочих признаков (всех признаков, помимо \"массовой доли\") указывай единицы измерения (за исключением признаков \"марка\" и \"стандарт\")\n   - Если признака в тексте нет - не извлекай его и не выводи его в json.\n\n4 . Выводи строго JSON следующего вида (пример):\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [26, 28]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20, null]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 20},\n    {\"вещество\": \"S\", \"массовая доля\": 3},\n    {\"вещество\": \"NH4+\", \"массовая доля\": [null, 2]}\n  ],\n  \"прочее\": [\n    {\"параметр\": \"масса нетто единицы\", \"масса\": 50, \"единица\": \"кг\"},\n    {\"параметр\": \"масса брутто\", \"масса\": 1020, \"единица\": \"кг\"},\n    {\"параметр\": \"количество поддонов\", \"количество\": 20, \"единица\": \"шт\"},\n    {\"параметр\": \"количество мешков\", \"количество\": 1000, \"единица\": \"шт\"},\n    {\"параметр\": \"объем нетто единицы\", \"объем\": 10, \"единица\": \"л\"},\n    {\"параметр\": \"стандарт\", \"значение\": \"ТУ 2184-037-32496445-02\"},\n    {\"параметр\": \"марка\", \"значение\": \"N7-P20-K30-S3\"}\n  ]\n}\n\n5. Выводи json результат **только после слова ОТВЕТ:**.\n\nТекст для анализа:\nКАЛИЙ СЕРНОКИСЛЫЙ ИЗ НЕФЕЛИНОВОГО СЫPЬЯ ТУ 20.15.52-089-05785164-2022, ПРЕДНАЗНАЧЕН ДЛЯ ПРИМЕНЕНИЯ В КАЧЕСТВЕ МИНЕРАЛЬНОГО УДОБРЕНИЯ В СЕЛЬСКОМ ХОЗЯЙСТВЕ, ПОЛУЧАЮТ ИЗ ВЕТВИ ТЕХНОЛОГИЧЕСКОГО ПРОЦЕССА ПРОИЗВОДСТВА СОДОПРОДУКТОВ ИЗ РАСТВОРОВ ГЛИНОЗЕМНОГО ПРОИЗВОДСТВА",
  "parsing_errors": [
    "Текст #10: невалидный JSON. Ответ: ```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [7.4, 7.4]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [19.7, 19.7]},\n    {\"вещество\": \"K2O\", \"массовая доля\": [2...",
    "Текст #17: невалидный JSON. Ответ: ```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"K2O\", \"массовая доля\": [53.3, 53.1]},\n    {\"вещество\": \"Na\", \"массовая доля\": [null, null]},\n    {\"вещество\": \"Ca\", \"массовая доля\": [...",
    "Текст #24: невалидный JSON. Ответ: .\n```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [26, 28]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [19, 21]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 19},\n ...",
    "Текст #26: невалидный JSON. Ответ: **Описание:**\n* Удобрение, которое содержит сульфат аммония.\n* Сульфат аммония - это удобрение, которое содержит азот.\n* Сульфат аммония - это удобрение, которое содержит азот и фосфор.\n* Сульфат аммо...",
    "Текст #28: невалидный JSON. Ответ: , УДОБРЕНИЕ МИНЕРАЛЬНОЕ ГРАНУЛИРОВАННОЕ NPK 3:20:30, СОДЕРЖАЩЕЕ ТРИ ПИТАТЕЛЬНЫХ ЭЛЕММЕНТА АЗОТ-3%, ФОСФОР-20%, КАЛИЙ-30%, В 390 БИГ-БЭГАХ, УДОБРЕНИЕ МИНЕРАЛЬНОЕ ГРАНУЛИРОВАННОЕ NPK 3:20:30, СОДЕРЖАЩЕЕ...",
    "Текст #36: невалидный JSON. Ответ: **Описание:**\nСульфат аммония кристаллический (удобрение) - это удобрение, которое используется для повышения урожайности. \n \n**Состав:**\nСостав сульфата аммония кристаллического (удобрение) включает ...",
    "Текст #38: невалидный JSON. Ответ: ```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [26, 28]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20, null]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 20},\n ...",
    "Текст #39: невалидный JSON. Ответ: . МАССОВАЯ ДОЛЯ К2О - 20%.\n```\n\n**Ответ:**\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [26, 28]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20, 20]},\n    {\"вещество\": \"K2O\",...",
    "Текст #50: невалидный JSON. Ответ: .\n```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"Ca\", \"массовая доля\": [null, 25]},\n    {\"вещество\": \"N\", \"массовая доля\": [null, 2]}\n  ],\n  \"прочее\": [\n    {\"параметр\": \"масса брут...",
    "Текст #53: невалидный JSON. Ответ: .\n```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [13, 15]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [40, 42]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 13},\n ...",
    "Текст #59: невалидный JSON. Ответ: ```\n\n**Ответьте:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [26, 28]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20, null]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 20}...",
    "Текст #67: невалидный JSON. Ответ: .\n\n```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [20, 28]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20, null]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 20}...",
    "Текст #73: невалидный JSON. Ответ: ```\n\n**Ответ:**\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"K\", \"массовая доля\": [46.2, null]},\n    {\"вещество\": \"N\", \"массовая доля\": [13.8, null]},\n    {\"вещество\": \"S\", \"массовая доля\": [0.09,...",
    "Текст #74: невалидный JSON. Ответ: **Состав:**\n* Азот: 16%\n* Фосфор: 14%\n* Кальций: 10%\n* Масса нетто единицы: 50 кг\n* Масса брутто: 1020 кг\n* Количество мешков: 1000 шт\n* Объем нетто единицы: 10 л\n* Стандарт: ТУ 2186-687-00209438-08\n*...",
    "Текст #76: невалидный JSON. Ответ: ```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20, null]},\n    {\"вещество\": \"CaO\", \"массовая доля\": 47.4},\n    {\"вещество\": \"F\", \"массовая доля\": [3.4, null...",
    "Текст #77: невалидный JSON. Ответ: НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. НАСЫПЬ. ...",
    "Текст #86: невалидный JSON. Ответ: 1. СОДЕРЖАНИЕ АЗОТА В ПЕРЕСЧЕТЕ НА СУХОЙ ПРОДУКТ 10%\n2. СОДЕРЖАНИЕ К2О В ПЕРЕСЧЕТЕ НА СУХОЙ ПРОДУКТ 20%\n3. СОДЕРЖАНИЕ СУЛЬФАТА АММОНИЯ В ПЕРЕСЧЕТЕ НА СУХОЙ ПРОДУКТ 21%\n4. СОДЕРЖАНИЕ АММОНИЯ В ПЕРЕСЧЕТ...",
    "Текст #88: невалидный JSON. Ответ: , УДОБРЕНИЕ МИНЕРАЛЬНОЕ ГРАНУЛИРОВАННОЕ NP (S) 20:20 (14), СОДЕРЖАЩЕЕ ДВА ПИТАТЕЛЬНЫХ ЭЛЕММЕНТА АЗОТ-20%, ФОСФОР-20%, В 65 БИГ-БЭГАХ, УДОБРЕНИЕ МИНЕРАЛЬНОЕ ГРАНУЛИРОВАННОЕ NP (S) 20:20 (14), СОДЕРЖАЩЕ...",
    "Текст #89: невалидный JSON. Ответ: ```\n\n**Ответьте:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [26, 28]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20, null]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 20}...",
    "Текст #94: невалидный JSON. Ответ: ```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"N\", \"массовая доля\": [20.0, 21.0]},\n    {\"вещество\": \"P2O5\", \"массовая доля\": [20.0, 21.0]},\n    {\"вещество\": \"K2O\", \"массовая доля\": ...",
    "Текст #96: невалидный JSON. Ответ: - ЭЛЕМЕНТАРНАЯ СМЕСЬ.\n\n```\n\n**Ответ:**\n\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"P2O5\", \"массовая доля\": [10.8, null]},\n    {\"вещество\": \"K2O\", \"массовая доля\": 16.3},\n    {\"вещество\": \"B\", \"м...",
    "Текст #97: невалидный JSON. Ответ: **\n```json\n{\n  \"массовая доля\": [\n    {\"вещество\": \"K2O\", \"массовая доля\": [53.0, null]},\n    {\"вещество\": \"Na\", \"массовая доля\": [null, null]},\n    {\"вещество\": \"Ca\", \"массовая доля\": [null, null]},\n..."
  ],
  "total_samples": 100,
  "valid_json_count": 78,
  "invalid_json_count": 22
}